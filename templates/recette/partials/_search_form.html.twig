<!-- Formulaire de recherche avancée -->
<div class="card mb-4">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="card-title mb-0 h5">
                <i class="bi bi-funnel" aria-hidden="true"></i> Recherche avancée
            </h2>
            <button class="btn btn-outline-secondary btn-sm" 
                    type="button" 
                    data-bs-toggle="collapse" 
                    data-bs-target="#searchCollapse"
                    aria-expanded="false"
                    aria-controls="searchCollapse"
                    aria-label="Afficher ou masquer les filtres de recherche">
                <i class="bi bi-chevron-down" aria-hidden="true"></i>
            </button>
        </div>
        
        <div class="collapse" id="searchCollapse">
            {{ form_start(searchForm, {'attr': {'class': 'row g-3'}}) }}
                <div class="col-md-4">
                    {{ form_row(searchForm.query, {'label_attr': {'class': 'form-label'}}) }}
                </div>
                
                <div class="col-md-2">
                    {{ form_row(searchForm.categorie, {'label_attr': {'class': 'form-label'}}) }}
                </div>
                
                <div class="col-md-2">
                    {{ form_row(searchForm.difficulte, {'label_attr': {'class': 'form-label'}}) }}
                </div>
                
                <div class="col-md-2">
                    {{ form_row(searchForm.tempsMax, {'label_attr': {'class': 'form-label'}}) }}
                </div>
                
                <div class="col-md-2">
                    {{ form_row(searchForm.tri, {'label_attr': {'class': 'form-label'}}) }}
                </div>
                
                <div class="col-12 d-flex gap-2">
                    <button type="submit" class="btn btn-success">
                        <i class="bi bi-search" aria-hidden="true"></i> Rechercher
                    </button>
                    <a href="{{ path('app_recette_index') }}" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-clockwise" aria-hidden="true"></i> Reset
                    </a>
                </div>
            {{ form_end(searchForm) }}
        </div>
    </div>
</div>

<script>
// Ouvrir automatiquement le panneau si des filtres sont appliqués
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const hasFilters = Array.from(urlParams.keys()).some(key => 
        key.startsWith('recherche_avancee') && urlParams.get(key)
    );
    
    if (hasFilters) {
        const collapseEl = document.getElementById('searchCollapse');
        const btnEl = document.querySelector('[data-bs-target="#searchCollapse"]');
        new bootstrap.Collapse(collapseEl, { show: true });
        if (btnEl) btnEl.setAttribute('aria-expanded', 'true');
    }
});
</script>