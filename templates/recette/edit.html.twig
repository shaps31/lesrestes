{% extends 'base.html.twig' %}

{% block title %}Modifier {{ recette.nom }} - Les Restes{% endblock %}

{% block body %}
<div class="container">
    <!-- Header avec retour -->
    <div class="mb-4">
        <a href="{{ path('app_profil') }}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Retour à mon profil
        </a>
    </div>
    
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <h2 class="mb-4">Modifier ma recette</h2>
            
            {{ include('recette/_form.html.twig', {'button_label': 'Mettre à jour'}) }}
            
            <!-- Actions supplémentaires -->
            <div class="mt-4 pt-3 border-top">
                <h6 class="text-muted">Actions</h6>
                <div class="d-flex gap-2">
                    <a href="{{ path('app_recette_show', {'id': recette.id}) }}" class="btn btn-outline-primary">
                        <i class="bi bi-eye"></i> Aperçu
                    </a>
                    {{ include('recette/_delete_form.html.twig') }}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Masquer la prévisualisation automatique de VichUploader */
    .vich-image,
    .vich-image img {
        display: none !important;
    }
    
    /* Afficher seulement notre miniature custom */
    .bg-light.rounded.border img {
        display: block !important;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const images = document.querySelectorAll('form img[src*="/uploads/recettes/"]');
        images.forEach(function(img) {
            if (!img.closest('.bg-light')) {
                const parent = img.closest('.vich-image') || img.parentElement;
                if (parent && parent.tagName !== 'FORM') {
                    parent.remove();
                }
            }
        });
    });
</script>
{% endblock %}